# 第一题

## 连续问题

思路：使用开窗函数去构造一列，然后通过时间列去减这个排序的构造列。如果时间是连续的话，减去的差值是一样的，这样就把连续的时间划分在一个分组里面。

关键词：DATE_SUB     INTERVAL xx day

## 连续问题进阶版

思路二：也是可以通过开窗函数去做，开窗取出分组内的上一条数据，然后做一个 datediff 的操作，在通过 sum if 的开窗函数去累加。如果连续的一直加 0  ，不连续的就加 1 从而区分开

关键词：lag    sum(if( DATEDIFF(login_time ,last_day) <= 2 ,0 ,1))



进阶版的解法，可以用于中间间断的连续问题。类似这种需求：

 求每个用户最大的连续登陆天数，断一天还算连续登录（两个日期的差小于或等于 2 ）。

